<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>FAQ - Predbat Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "FAQ";
        var mkdocs_page_input_path = "faq.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Predbat Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../what-does-predbat-do/">What does Predbat do?</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../caution/">Words of caution</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Installing & configuring Predbat</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../installation-summary/">Install summary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install/">Install details</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../inverter-setup/">Inverter setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../apps-yaml/">apps.yaml settings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../energy-rates/">Energy rates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../components/">Predbat Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../load-ml/">ML Load Prediction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../car-charging/">Car charging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../configuration-guide/">Configuration guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../customisation/">Customisation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../video-guides/">Video Guides</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">FAQ</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#ive-installed-predbat-but-i-dont-see-the-correct-entities">I've installed Predbat but I don't see the correct entities</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#predbat-is-failing-with-warn-service-call-selectselect_option-data-failed">Predbat is failing with Warn: Service call select/select_option data failed</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#why-is-my-house-load-lower-than-expected-or-zero">Why is my house load lower than expected, or zero?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#why-is-my-predicted-charge-higher-or-lower-than-i-might-expect">Why is my predicted charge % higher or lower than I might expect?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#why-didnt-the-slot-get-configured">Why didn't the slot get configured?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#my-plan-doesnt-include-any-charging">My plan doesn't include any charging?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#the-charge-limit-keeps-increasingdecreasing-in-the-charge-window-or-is-unstable">The charge limit keeps increasing/decreasing in the charge window or is unstable</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#i-changed-a-config-item-but-it-made-no-difference">I changed a config item but it made no difference?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#its-all-running-but-im-not-getting-very-good-results">It's all running but I'm not getting very good results</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#in-my-power-flow-diagram-my-grid-power-is-the-wrong-way-around">In my power flow diagram my grid power is the wrong way around</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#my-plan-is-freeze-charging-or-holding-at-100-battery-a-lot">My plan is freeze charging or holding at 100% battery a lot</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#when-my-battery-is-charging-to-100-it-fluctuates-between-98-and-100-andor-gives-an-error-setting-reserve">When my battery is charging to 100% it fluctuates between 98% and 100%, and/or gives an error setting reserve</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#the-plan-doesnt-charge-or-discharge-when-i-expect-it-to">The plan doesn't charge or discharge when I expect it to</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#predbat-is-causing-warning-messages-about-exceed-maximum-size-in-the-home-assistant-core-log">Predbat is causing warning messages about 'exceed maximum size' in the Home Assistant Core log</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#error-metric_octopus_import-not-set-correctly-or-no-energy-rates-can-be-read">Error - metric_octopus_import not set correctly or no energy rates can be read</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#warn-no-solar-data-has-been-configured">WARN: No solar data has been configured</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#note-can-not-find-battery-charge-curve">Note: Can not find battery charge curve</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#warn-inverter-is-in-calibration-mode">WARN: Inverter is in calibration mode</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#inverter-time-is-xxx-predbat-computer-time-is-xxx-this-is-xxx-minutes-skewed-predbat-may-not-function-correctly">Inverter time is xxx, Predbat computer time is xxx, this is xxx minutes skewed, Predbat may not function correctly</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#i-have-another-problem-not-listed-above">I have another problem not listed above</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../devices/">Support 3rd party devices/integrations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../manual-api/">Manual API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Viewing Predbat data</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../output-data/">Output data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../web-interface/">Web Interface</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../predbat-plan-card/">Predbat Plan card</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../creating-charts/">Creating the charts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../compare/">Comparing Energy Tariffs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Predbat development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../todo-list/">To-do list</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../developing/">Developing on Predbat</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rest_api/">Predbat REST API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins/">üöÄ Feature: Plugin System Implementation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Predheat</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../predheat/">Predheat</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Predbat Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Installing & configuring Predbat</li>
      <li class="breadcrumb-item active">FAQ</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="faq">FAQ</h1>
<h2 id="ive-installed-predbat-but-i-dont-see-the-correct-entities">I've installed Predbat but I don't see the correct entities</h2>
<ul>
<li>First look at predbat.status in Home Assistant and the Predbat/AppDaemon app log (which can be found in the list of log files in the System/Log area of the GUI).
See if any errors are warnings are found. If you see an error something is likely configured incorrectly,
check your entity settings are correct.</li>
<li>Make sure Solcast is installed and it's auto-updated at least a couple of times a day (see the <a href="../install/#solcast-install">Solcast instructions</a>).
The default Solcast sensor names may be wrong, you might need to update the <code>apps.yaml</code> config to match your own names
(some people don't have the solcast_ bit in their names)</li>
</ul>
<h2 id="predbat-is-failing-with-warn-service-call-selectselect_option-data-failed">Predbat is failing with Warn: Service call select/select_option data failed</h2>
<p>Here's an example error message:</p>
<pre><code class="language-text">2026-01-14 15:10:43.706153: Warn: Service call select/select_option data
{'option': '17:00:00', 'entity_id':
'select.predbat_fox_603j303046yp036_battery_schedule_charge_end_time'}
failed
</code></pre>
<p>This will happen if you have no actual selectors provided by integrations in Home Assistant before Predbat starts. You can workaround this by adding a
dummy selector to <code>configuration.yaml</code> and restarting HA e.g:</p>
<pre><code class="language-yaml">template:
  - select:
      - name: &quot;simple_select&quot;
        state: &quot;{{ states('input_select.my_input') }}&quot;  # Current value
        options: &quot;{{ ['Option 1', 'Option 2', 'Option 3'] }}&quot;  # Available options
        select_option:
          - service: input_select.select_option
            target:
              entity_id: input_select.my_input
            data:
              option: &quot;{{ option }}&quot;
</code></pre>
<h2 id="why-is-my-house-load-lower-than-expected-or-zero">Why is my house load lower than expected, or zero?</h2>
<p>If your house load is unusually low in the Predbat plan, then its often due to Predbat excluding some of your house load.</p>
<ul>
<li>Are your <strong>load_today</strong>, <strong>import_today</strong>, <strong>export_today</strong> and <strong>pv_today</strong> entries in <code>apps.yaml</code> correctly configured and pointing to the right inverter/Home Assistant entities?</li>
<li>Check the history of these entities, are there gaps in them or do the entities go down during the day rather than continually increment - these need to be resolved if they do not increment continually over the day and reset at midnight.</li>
<li>Have you accidentally used a power sensor (W or kW) rather than a daily energy sensor (Wh or kWh)?</li>
<li>In the logfile do you see car/iBoost energy being excluded, e.g. "Today's predicted so far 19.0kWh with 3.2kWh car/iBoost excluded"?</li>
<li>If energy is being excluded and you have an EV/iBoost, have you configured the correct <strong>car_charging_energy</strong> energy sensor(s) to <a href="../car-charging/#filtering-car-charging-energy-from-house-load">filter car charging energy</a> in <code>apps.yaml</code>?</li>
<li>Do these sensors increment over the day or are there gaps or resets back to zero during the day?  Use a daily utility meter to wrap around your EV charger sensor to provide Predbat with a sensor that doesn't do this.</li>
<li>Depending on the wiring of your EV charger and inverter, the inverter may not 'see' the EV charging energy.
If you configure car_charging_energy in <code>apps.yaml</code> then Predbat will be calculating an artificially low house load - turn <strong>switch.car_charging_hold</strong> off to stop this.</li>
<li>If you don't have a sensor that provides car charging energy then Predbat will use <strong>input_number.predbat_car_charging_threshold</strong> as the
<a href="../car-charging/#filtering-car-charging-energy-from-house-load">threshold to detect car charging</a> - adjust as necessary for your EV charger.</li>
<li>If you don't have an EV charger then turn <strong>switch.car_charging_hold</strong> off as Predbat will still use <strong>input_number.predbat_car_charging_threshold</strong> and assume any house load above this is EV charging.</li>
</ul>
<h2 id="why-is-my-predicted-charge-higher-or-lower-than-i-might-expect">Why is my predicted charge % higher or lower than I might expect?</h2>
<ul>
<li>Predbat is based on cost, so it will try to save you money. If you have the PV 10% option enabled it will also
take into account the worst-case scenario and how often it might happen, so if the forecast is a bit unreliable
it's better to charge more and not risk getting stung importing.</li>
<li>Have you checked your energy rates for import and export are correct, maybe check the rates graph and confirm.
If you do something like have export&gt;import then Predbat will try to export as much as possible.</li>
<li>Have you tuned Solcast to match your output accurately?</li>
<li>Have you tuned <strong>predbat_best_soc_keep settings</strong>?</li>
<li>Do you have predicted car charging during the time period?</li>
<li>You can also tune <strong>predbat_load_scaling</strong> and <strong>predbat_pv_scaling</strong> to adjust predictions up and down a bit</li>
</ul>
<h2 id="why-didnt-the-slot-get-configured">Why didn't the slot get configured?</h2>
<ul>
<li>Are you in read-only mode?</li>
</ul>
<h2 id="my-plan-doesnt-include-any-charging">My plan doesn't include any charging?</h2>
<ul>
<li>Do you have the predbat_mode set to Control charge (or Control charge &amp; discharge)?</li>
</ul>
<h2 id="the-charge-limit-keeps-increasingdecreasing-in-the-charge-window-or-is-unstable">The charge limit keeps increasing/decreasing in the charge window or is unstable</h2>
<ul>
<li>Check you don't have any other automations running that adjust GivTCP settings during this time. Some people had
a script that changes the reserve %, this will cause problems - please disable other automations and retry.</li>
</ul>
<h2 id="i-changed-a-config-item-but-it-made-no-difference">I changed a config item but it made no difference?</h2>
<ul>
<li>You might have to wait a few minutes until the next update cycle. Depending on the speed of the computer that Predbat is running on, it can take 1-5 minutes for Predbat to run through.
You can see the date/time that Predbat last completed a run at the start of the <a href="../predbat-plan-card/">Predbat HTML plan</a>.</li>
</ul>
<h2 id="its-all-running-but-im-not-getting-very-good-results">It's all running but I'm not getting very good results</h2>
<ul>
<li>You might want to tune <strong>input_number.predbat_best_soc_keep</strong> to set a minimum target battery level, e.g. I use 2.0 (for 2kWh, which is just over 20% on a 9.5kWh battery).
If you set <strong>input_number.predbat_best_soc_keep</strong> too high then Predbat could need to charge the battery at unfavourable import rates, so try to set it to a fairly low value,
especially if you have a small battery. If you set it to zero then Predbat may not charge at all, so use 0.1 as a minimum.</li>
<li>Have a read of the <a href="../energy-rates/">energy rates configuration guide</a> as depending on your tariff different settings may be required</li>
<li>Check your solar production is well calibrated (you can compare Solcast vs actually in the Home Assistant energy tab or on the GivEnergy portal)</li>
<li>Make sure your inverter max AC rate has been set correctly</li>
<li>If you have an EV that you charge then you will want some sort of car charging sensor or use the basic car charging hold feature or your load predictions may be unreliable - see
<a href="../car-charging/">Car charging</a></li>
<li>Do you have a solar diverter? If so maybe you want to try using the <a href="../customisation/#iboost-model-solar-diverter-options">iBoost model settings</a>.</li>
<li>Perhaps set up the calibration chart and let it run for 24 hours to see how things line up</li>
<li>If your export slots are too small compared to expected check your inverter_limit is set correctly (see below)</li>
</ul>
<h2 id="in-my-power-flow-diagram-my-grid-power-is-the-wrong-way-around">In my power flow diagram my grid power is the wrong way around</h2>
<p>You may need to set '<strong>grid_power_invert</strong> to True if your <strong>grid_power</strong> is positive when importing.</p>
<h2 id="my-plan-is-freeze-charging-or-holding-at-100-battery-a-lot">My plan is freeze charging or holding at 100% battery a lot</h2>
<p><strong>Round trip losses</strong></p>
<p>Round trip losses for charging the battery and then using it for your home are:</p>
<p><strong>charge loss</strong> x <strong>inverter loss</strong> x <strong>inverter loss</strong> x <strong>discharge loss</strong></p>
<p>The default is therefore: $0.97 * 0.96 * 0.96 * 0.97 \approx 0.87$ (13%)</p>
<p>If you freeze charge or hold at 100% then you will be using the grid which is 13% cheaper than using the battery at the same import rate.
If you start increasing these losses to say 5% and 6% then you are getting to around 20% round trip losses.
This means charging the battery at 20p is the same cost as using the grid at 25p.</p>
<p>However, if you start setting <strong>metric_self_sufficiency</strong> then you are telling Predbat to try to import <em>less</em> when possible.
If your round trip losses are 20% then using the grid directly will import 20% less energy than charging your battery.
Therefore a 5p metric self-sufficiency will effectively add another 1p to this difference i.e. using the grid at 26p is now the same as charging the battery at 20p!</p>
<p>If you set <strong>metric_battery_cycle</strong> to say 2p then that would add another 4p to using the battery so now charging at 20p would equate to using the grid at 30p!</p>
<p><em>Bottom line, be careful how you configure things.</em></p>
<h2 id="when-my-battery-is-charging-to-100-it-fluctuates-between-98-and-100-andor-gives-an-error-setting-reserve">When my battery is charging to 100% it fluctuates between 98% and 100%, and/or gives an error setting reserve</h2>
<p>Some inverters e.g. GE AIO inverter won't allow the reserve to be set to 100, in which case set in apps.yaml</p>
<pre><code class="language-yaml">  inverter_reserve_max : 98
</code></pre>
<p>And this should prevent the issue</p>
<h2 id="the-plan-doesnt-charge-or-discharge-when-i-expect-it-to">The plan doesn't charge or discharge when I expect it to</h2>
<p>Predbat can only work on the information it's given, although it does run every 5 minutes to execute the plan, and updates and re-evaluates the plan every 10 minutes, adjusting if necessary.</p>
<p>The plan Predbat produces assumes that your average load and PV forecasts are accurate and Predbat will aim to give you the maximum return.</p>
<p>Make sure you have set up your <a href="../install/#solcast-install">Solcast solar forecast correctly</a> with the number of panels, orientation, output, etc.</p>
<p>Projected daily load is determined from historical load information so make sure you have set <a href="../apps-yaml/#basics">days_previous and days_previous_weight in apps.yaml</a>
to give appropriately representative load history to Predbat, and read the <a href="../apps-yaml/#understanding-how-days_previous-works">longer explanation of how days_previous works</a>.</p>
<p>You could adjust <strong>input_number.predbat_load_scaling</strong> to 1.2 so the plan will incorporate 20% more expected load if you want to be more pessimistic about historical load,
and <strong>input_number.predbat_pv_scaling</strong> to similarly adjust the PV forecast - these and other adjustment options are described in the <a href="../customisation/#scaling-and-weight-options">Scaling and Weight options</a>.</p>
<p>It is very important to correctly set Predbat's <a href="../customisation/#battery-loss-options">Battery Loss Options</a>
and <a href="../customisation/#battery-margins-and-metrics-options">Battery Margins</a> as these can have a huge and critical impact on the plan that Predbat generates.</p>
<p>Predbat's default configuration values are the recommended starting values for most users but there is no single right set of configuration values for every user of Predbat,
it depends on many factors and your personal preferences. Many users will need to customise and tweak their <a href="../customisation/">Predbat configuration</a> to suit their needs.</p>
<p>The SoC level that Predbat aims to keep in the battery <strong>input_number.predbat_best_soc_keep</strong>
and the absolute minimum SoC level <strong>input_number.predbat_best_soc_min</strong> are the first things to check.
If these are set too high then Predbat will charge at unfavourable rates to maintain the battery SoC.
Conversely, if you find Predbat is letting the battery exhaust too early, set predbat_best_soc_keep to 1.0 so Predbat will aim to keep 1kWh available for unexpected load.</p>
<p>Predbat performs a lowest-cost battery optimisation so a key part of deciding whether to charge, discharge or feed the house from the battery are the loss rates
<strong>input_number.predbat_battery_loss</strong>, <strong>input_number.predbat_battery_loss_discharge</strong> and <strong>input_number.predbat_inverter_loss</strong>.
Typical values could be 4, 4, 4 or 5, 5, 5.  It is tempting to set these inverter loss figures lower to encourage Predbat to use the battery more,
but this should be resisted as experience from the GivEnergy community forum suggests total energy conversion losses are in the range of 10-20%.</p>
<p>Putting these losses into context and assuming you have an AC-coupled battery and have set the losses to 4, 4 and 4;
then for every kWh charged from the grid, you will only get 0.92kWh stored in the battery (4% charge + 4% inverter conversion loss)
and similarly when that 0.92kWh is discharged to the home you will only receive 0.85kWh (0.92 x 0.92).</p>
<p>These loss percentages also impact the Predbat plan. Consider an import rate of 20p/kWh; after conversion losses are considered,
each 1kWh of stored battery charge will in effect have cost 21.7p (20 / 0.92) to import.</p>
<p>Then for discharging, the same applies. Each kWh of stored battery charge (that costs 21.7p to charge) will in effect have cost 23.6p (21.7 / 0.92) to discharge.
Predbat makes cost optimisation decisions so unless the current import rate is more than 23.6p, it will be cheaper to let the home run off grid import rather than to discharge the battery.</p>
<p>If you turn <a href="../predbat-plan-card/#debug-mode-for-predbat-plan">debug mode on for the Predbat plan</a> then you can see the
effective import and export rates after losses that Predbat calculates in the Predbat plan.</p>
<p>Predbat also uses <strong>input_number.predbat_metric_battery_cycle</strong> (<em>expert mode</em> setting) to apply a 'virtual cost' in pence per kWh for charging and discharging the battery.
The default value is 1p but this this can be changed to a different value to recognise the 'cost of using the battery', or set to zero to disable this feature.</p>
<p>So if the metric battery cycle is set to 1p, and continuing the example above, each kWh of battery charge will be costed at 22.7p (21.7p + 1p battery metric to charge),
and the battery will not be discharged to support the home unless the current import rate is more than 25.6p (23.6p + 1p cost of charging + 1p cost to discharge).</p>
<p><strong>input_number.predbat_metric_min_improvement</strong> and <strong>input_number.predbat_metric_min_improvement_discharge</strong> (both <em>expert mode</em> settings) also affect Predbat's cost optimisation decisions
as to <a href="../customisation/#battery-margins-and-metrics-options">whether it is cost beneficial to charge or discharge the battery</a>
so could be tweaked if you feel Predbat is charging or discharging with marginal benefits. The defaults (0p and 0.1p respectively) should however give good results for most users.</p>
<p>Finally, it could be worth considering adding <a href="../energy-rates/#manually-over-riding-energy-rates">import or export rate increments</a> to <code>apps.yaml</code> if you want to direct Predbat
to avoid or encourage charging or discharging in certain time periods - e.g. avoiding exporting in the time period saving sessions normally fall in,
or to encourage discharging just before import rates fall overnight.</p>
<h2 id="predbat-is-causing-warning-messages-about-exceed-maximum-size-in-the-home-assistant-core-log">Predbat is causing warning messages about 'exceed maximum size' in the Home Assistant Core log</h2>
<p>If you have a large <strong>input_number.predbat_forecast_plan_hours</strong> then you may see warning messages in the Home Assistant Core log about the size of a number of Predbat entities,
the message will be "State attributes for predbat.<em>XXXX</em> exceed maximum size of 16384 bytes".</p>
<p>This is just a warning, the Predbat entity attributes aren't stored in the database anyway,
but you can suppress these warnings by adding the following to your <code>configuration.yaml</code> file:</p>
<pre><code class="language-yaml"># Filter out 'message too large' warnings from Predbat entities
logger:
  default: warning
  filters:
    homeassistant.components.recorder.db_schema:
      - &quot;State attributes for predbat.base10_export_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.base10_import_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.base10_metric exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.base10_pv_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.battery_cycle exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.battery_cycle_best exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.battery_power exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.battery_power_best exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best_charge_limit exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best_export_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best_import_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best_load_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best_metric exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best_pv_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best10_export_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best10_import_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best10_metric exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.best10_pv_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.cost_today_export exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.cost_today_import exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.cost_yesterday exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.export_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.grid_power exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.grid_power_best exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.import_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.load_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.load_energy_actual exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.load_energy_adjusted exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.load_energy_predicted exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.load_power exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.load_power_best exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.metric exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.plan_html exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.pv_energy exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.pv_power exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.pv_power_best exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.rates exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.soc_kw exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.soc_kw_base10 exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.soc_kw_best exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
      - &quot;State attributes for predbat.soc_kw_best10 exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored&quot;
</code></pre>
<h2 id="error-metric_octopus_import-not-set-correctly-or-no-energy-rates-can-be-read">Error - metric_octopus_import not set correctly or no energy rates can be read</h2>
<p>If you get this error in the Predbat log file:</p>
<ul>
<li>Check that the Octopus integration is working and that <strong>event.octopus_energy_electricity_METER_NUMBER_current_day_rates</strong>
and <strong>sensor.octopus_electricity_energy_METER_NUMBER_current_rate</strong> are both populated by the integration.</li>
<li>Ensure that you have followed the <a href="../install/#octopus-energy">Octopus Integration Installation instructions</a>, including enabling the Octopus Integration events.</li>
<li>If you have been using an older version of the Octopus integration and have upgraded to version 9 or above, then you may find that your energy sensors are named <strong>sensor.electricity_METER_NUMBER_current_rate</strong>
(i.e. no 'octopus_energy_' prefix) but the 'event' entities have the 'octopus_energy' prefix.<BR>
If the 'event' and 'sensor' entities are not consistently named then Predbat will not be able to find the event entities if the sensor names don't match what's expected.<BR>
To fix this, uninstall the Octopus integration, reboot Home Assistant,
delete all the old Octopus sensors, and <a href="../install/#octopus-energy">re-install the Octopus Integration</a>.</li>
</ul>
<h2 id="warn-no-solar-data-has-been-configured">WARN: No solar data has been configured</h2>
<p>If you get this warning message in the Predbat log file or you see that the 'PV kWh' column in the <a href="../predbat-plan-card/">Predbat plan card</a> is completely blank:</p>
<ul>
<li>Ensure that you have <a href="../install/#solcast-install">installed and configured Solcast correctly</a></li>
<li>Check the Solcast integration in Home Assistant is configured and enabled (go to Settings / Integrations / Solcast )</li>
<li>Check that there are no errors relating to Solcast in the Home Assistant log (go to Settings / System / Logs and view the 'Home Assistant Core' log).
If you see an error 429 message in the log then this is as a result of  Solcast's rate limiting for Hobbyist accounts.
The only fix is to re-run the 'Solcast update' automation and hope that Solcast isn't as busy when you re-run.</li>
<li>Verify the solar forecast has been populated in Home Assistant by going to 'Settings' / 'Developer Tools' / 'States', filtering on 'solcast',
and check that you can see the half-hourly solar forecasts in the Solcast entities</li>
<li>If you can see the Solcast entities but there are no forecast PV figures, try running the 'Solcast update' automation you created, and check again the Solcast entities</li>
<li>If the Solcast entities are still not populated, try reloading the Solcast integration (go to System / Devices &amp; Services / Integrations tab, click on 'Solcast PV Forecast',
click the three vertical dots beside 'Configure' and choose 'Reload' from the dropdown menu)</li>
<li>Check <strong>sensor.solcast_pv_api_limit</strong> (it's normally 10 for new Solcast accounts) meaning you can call the Solcast API 10 times a day
(but if you have two solar arrays, e.g. East/West) then retrieving the forecast will count as two API calls.<BR>
Compare this to <strong>sensor.solcast_pv_api_used</strong> to see how many Solcast API calls you have made today
(alternatively, you can confirm how many API calls you have made today by logging into your Solcast account).<BR>
If you've run out of API calls you will have to wait until midnight GMT for the API count to reset.
It's recommended that you don't include the Solcast forecast within your GivEnergy portal to avoid running out of API calls.</li>
<li>Check the <a href="https://status.solcast.com/">Solcast server API status</a> is OK</li>
</ul>
<h2 id="note-can-not-find-battery-charge-curve">Note: Can not find battery charge curve</h2>
<p>If you get the message "Note: Can not find battery charge curve, one of the required settings for soc_kw, battery_power and charge_rate are missing from apps.yaml" in the logfile
then Predbat tries to create a battery charge curve but does not have access to the required history information in Home Assistant.</p>
<p><a href="../apps-yaml/#battery-chargedischarge-curves">Creating the battery charge curve</a> is described in the <code>apps.yaml</code> document.
The most likely cause of the above message appearing in the logfile is that you are controlling a GivEnergy inverter in REST mode
but have not uncommented the following entities in <code>apps.yaml</code> that Predbat needs to obtain history from to create the battery charge curve:</p>
<pre><code class="language-yaml">  charge_rate:
    - number.givtcp_{geserial}_battery_charge_rate
  discharge_rate:
    - number.givtcp_{geserial}_battery_discharge_rate
  battery_power:
    - sensor.givtcp_{geserial}_battery_power
  soc_kw:
    - sensor.givtcp_{geserial}_soc_kwh
</code></pre>
<p>You should also check that all the entities Predbat highlights that it are using have history, and that the charging/discharging goes to full/empty as described in the battery curve documentation.</p>
<h2 id="warn-inverter-is-in-calibration-mode">WARN: Inverter is in calibration mode</h2>
<p>If you see the message "WARN: Inverter is in calibration mode, Predbat will not function correctly and will be disabled" in the logfile,
then Predbat has identified that your inverter is currently calibrating your battery. Predbat's status will also be set to 'Calibration'.</p>
<p>Predbat will set the inverter charge and discharge rates to maximum (if they are not already), SoC target to 100% and battery reserve to minimum (usually 4%),
and will not execute the plan nor enable battery charge or discharge.</p>
<p>Once the inverter finishes calibrating the battery, Predbat will resume normal operations.</p>
<h2 id="inverter-time-is-xxx-predbat-computer-time-is-xxx-this-is-xxx-minutes-skewed-predbat-may-not-function-correctly">Inverter time is xxx, Predbat computer time is xxx, this is xxx minutes skewed, Predbat may not function correctly</h2>
<p>If the <strong>predbat.status</strong> gives a warning error about the inverter time:</p>
<p><img alt="IMAGE" src="../images/Inverter-time-warning.png" /></p>
<p>Then it indicates that there is a mismatch between the clock that Predbat is using and the inverter time clock, and clearly with a clock mismatch,
charging and discharging your battery at specific times may not work as expected.</p>
<p>There are several potential causes of this problem:</p>
<ul>
<li>Check that the inverter time is correctly set, especially that it is set to GMT (even if it's summertime).
In the GivEnergy portal, go to My Inverters / Remote Control (cog symbol) / click SEND next to 'Set Date and Time'</li>
<li>Check that the <a href="../install/#appdaemon-install">time_zone in appdaemon.yaml</a> is correctly set for your location (e.g. Europe/London)</li>
<li>The time zone for <a href="../apps-yaml/#basics">Predbat in apps.yaml</a> needs to be set to the same value</li>
<li>Finally, check how often your inverter integration is polling your inverter for new data. For <a href="../apps-yaml/#rest-interface-inverter-control">GivTCP the Self Run Loop Timer</a>
is recommended to be set to a value of between 20 and 60 seconds.</li>
</ul>
<p>If you have checked the above and keep getting ‚Äútime is skewed‚Äù warnings then it means Home Assistant/predbat isn‚Äôt getting the same time from the inverter as it is expecting.
Either GivTCP has lost communications with the inverter or the inverter has stopped talking to the world.</p>
<p>If you look at the Logbook in Home Assistant you should see a steady stream of entities changing in HA.
In particular, you will see the GivTCP inverter time entity changing every polling period, e.g. every 20 seconds.</p>
<p>Possible fixes:</p>
<ul>
<li>restart the GivTCP app</li>
<li>restart Home Assistant (although usually restarting GivTCP is enough)</li>
<li>power the inverter off, turn off the panels and battery first, then the inverter, then follow the reverse sequence to power the inverter back on again.
This forces the inverter to reconnect to your wifi</li>
<li>do a ‚Äòreset to defaults‚Äô in the portal</li>
</ul>
<p>If you keep getting the warning message, even sporadically, then this points to an underlying issue in your home network between Home Assistant and the inverter.
You may need to add a Wi-Fi repeater or ideally a fixed Ethernet connection to your inverter to improve signal strength if this keeps happening.</p>
<p>There is a <a href="../output-data/#automated-monitoring-that-predbat-and-givtcp-are-running-ok">Home Assistant automation that will alert you if GivTCP stops sending data to predbat</a>.</p>
<h2 id="i-have-another-problem-not-listed-above">I have another problem not listed above</h2>
<p>If you are still having trouble feel free to raise a <a href="https://github.com/springfall2008/batpred/issues">GitHub ticket</a> for support</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../video-guides/" class="btn btn-neutral float-left" title="Video Guides"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../devices/" class="btn btn-neutral float-right" title="Support 3rd party devices/integrations">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../video-guides/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../devices/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
